<!-- HEADER -->
<header class="instance-header">
  <div class="header-left">
      <h1 class="text-3xl font-semibold text-gray-800">Start Application Instance</h1>
    
    <p class="page-sub">Review and confirm to start a new approval instance.</p>
  </div>
  <div class="header-right">
    <nz-breadcrumb style="font-size: 14px;">
      <nz-breadcrumb-item>
        <a (click)="goBack()" class="breadcrumb-link">Active Templates</a>
      </nz-breadcrumb-item>
      <nz-breadcrumb-item>Start Instance</nz-breadcrumb-item>
    </nz-breadcrumb>
  </div>
</header>

<div class="page-wrap max-w-3xl mx-auto">
  <!-- Page Header -->
  <div class="header flex flex-col md:flex-row items-start md:items-center justify-between mb-8 gap-2">
    <div class="flex items-center gap-3">
      <button nz-button nzType="default" nzGhost (click)="goBack()" class="flex items-center gap-2">
        <i nz-icon nzType="arrow-left"></i> Back
      </button>
    

  <!-- Step Tracker: render template stages dynamically -->
  <nz-steps [nzCurrent]="currentStep" nzSize="small" style="margin-bottom: 32px;" *ngIf="stages.length>0">
    <nz-step *ngFor="let s of stages" [nzTitle]="s.stageName"></nz-step>
  </nz-steps>


  <!-- Template Info Card -->
  <nz-card nzBordered class="shadow-md rounded-xl p-6 bg-gray-50 mb-6">
    <div class="template-summary">
      <div class="summary-left">
        <h3 class="text-lg font-semibold mb-2">{{ templateName || templateId }}</h3>
        </div>
      <div class="summary-right">
        <button nz-button nzType="default" (click)="goBack()">Choose different template</button>
      </div>
    </div>
  </nz-card>

  <!-- Form Card -->
  <nz-card nzBordered class="shadow-lg rounded-2xl bg-white form-card">
    <form nz-form [formGroup]="validateForm" (ngSubmit)="submitForm()" nzLayout="vertical">

      <!-- Form Fields -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Template -->
        <nz-form-item>
          <nz-form-label nzFor="templateId" nzRequired>Template</nz-form-label>
          <nz-form-control>
            <nz-input-group nzPrefixIcon="appstore">
              <input nz-input id="templateId" formControlName="templateId" readonly
                     class="bg-gray-100 font-medium text-gray-800" placeholder="Selected template" />
            </nz-input-group>
          </nz-form-control>
        </nz-form-item>

        <!-- Template name (readonly) -->
        <nz-form-item *ngIf="validateForm.get('templateName')?.value">
          <nz-form-label>Template Name</nz-form-label>
          <nz-form-control>
            <input nz-input id="templateName" formControlName="templateName" readonly class="bg-gray-100" />
          </nz-form-control>
        </nz-form-item>

        <!-- Starting user -->
        <nz-form-item>
          <nz-form-label>Starting As</nz-form-label>
          <nz-form-control>
            <input nz-input readonly [value]="currentUserDisplay" class="bg-gray-100" />
          </nz-form-control>
        </nz-form-item>

       
      </div>
      
      <!-- Actions -->
      <div class="form-actions">
        <button nz-button nzType="default" type="button" (click)="goBack()">Cancel</button>
        <button nz-button nzType="primary" type="submit" [disabled]="validateForm.invalid || starting" [nzLoading]="starting">
          <i nz-icon nzType="play-circle"></i>&nbsp;Start Instance
        </button>
      </div>



    </form>
  </nz-card>
</div>
