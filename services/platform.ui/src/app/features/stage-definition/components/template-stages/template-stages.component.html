<button nz-button nzType="link" (click)="openModal()" nzSize="small">
  <span nz-icon nzType="apartment" style="margin-right: 4px;"></span> Stages
</button>

<nz-modal
  nzDraggable
  nzCentered
  [(nzVisible)]="isVisible"
  nzTitle="Stage Definition Flow"
  (nzOnCancel)="handleCancel()"
  [nzStyle]="{ width: '900px', maxHeight: '750px' }"
  [nzBodyStyle]="{ padding: '32px 40px', maxHeight: '600px', overflowY: 'auto' }"
  nzCancelText="Close"
  [nzFooter]="null"
>
  <ng-container *nzModalContent>
    <div
      style="display: flex; gap: 32px; min-height: 560px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;"
    >
      <!-- Left: Vertical Steps -->
      <div
        class="left-panel"
        style="width: 550px; max-height: 100%; overflow-y: auto; border-right: 1px solid #d9d9d9; padding-right: 20px; box-sizing: border-box; background-color: #fff; border-radius: 6px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);"
      >
        <nz-steps
          nzDirection="vertical"
          [nzCurrent]="index"
          (nzIndexChange)="onIndexChange($event)"
          *ngIf="stages.length > 0"
          style="font-size: 15px;"
          nzSize="small"
        >
          <nz-step
            *ngFor="let stage of stages; let i = index"
            [nzTitle]="stage.stageName"
            [nzDescription]="stage.assignmentKey"
            [nzDisabled]="false"
            [nzStatus]="i === index ? 'process' : 'wait'"
          ></nz-step>
        </nz-steps>
        <p *ngIf="stages.length === 0" style="color: #999; font-style: italic; padding: 20px; text-align: center;">
          No stages available.
        </p>
      </div>

      <!-- Right: Stage Definition Details -->
      <div class="right-panel" style="width: 400px; box-sizing: border-box;">
        <h3
        style="margin-bottom: 24px; font-weight: 600; font-size: 22px; color: #222; border-bottom: 2px solid #1890ff; padding-bottom: 8px; word-break: break-word;"
      >
        <span
          nz-tooltip
          [nzTooltipTitle]="selectedStage.stageName"
          style="color: #1890ff;"
        >
          {{ selectedStage.stageName || 'N/A' }}
        </span>
      </h3>
      

        <div *ngIf="selectedStage.stageDefId; else noStage" style="display: flex; flex-direction: column; gap: 16px;">
          <!-- Assignment Type -->
          <div
            style="background: #fafafa; padding: 16px; border-radius: 6px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);"
          >
            <div style="font-size: 13px; color: #888;">
              <i nz-icon nzType="tag" style="margin-right: 6px;"></i> Assignment Type
            </div>
            <div style="font-size: 15px; font-weight: 500; color: #333;">
              {{ selectedStage.assignmentType }}
            </div>
          </div>

          <!-- Assignee -->
          <div
            style="background: #fafafa; padding: 16px; border-radius: 6px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);"
          >
            <div style="font-size: 13px; color: #888;">
              <i nz-icon nzType="user" style="margin-right: 6px;"></i> Assignee
            </div>
            <div style="font-size: 15px; font-weight: 500; color: #333;">
              {{ selectedStage.assignmentKey }}
            </div>
          </div>

          <!-- Status -->
          <div
            style="background: #fafafa; padding: 16px; border-radius: 6px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);"
          >
            <div style="font-size: 13px; color: #888;">
              <i nz-icon nzType="check-circle" style="margin-right: 6px;"></i> Status
            </div>
            <nz-tag [nzColor]="getStatusColor()" style="margin-top: 4px;">{{ getStatus() }}</nz-tag>
          </div>
        </div>

        <ng-template #noStage>
          <p style="color: #888; font-style: italic; font-size: 15px; margin-top: 20px;">
            No stage selected.
          </p>
        </ng-template>
      </div>
    </div>
  </ng-container>
</nz-modal>
